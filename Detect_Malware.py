import os
from termcolor import cprint
from loading import initializingNetstat, netstatPortNumber

os.system('cls')
cprint(
    "\n===========================================================================================================================================================",
    'red')
cprint(
    "===========================================================================================================================================================",
    'red')
cprint(
    "===========================================================================================================================================================\n",
    'red')

cprint(
    "                                           ███████████████████████████████████████████████████████████████████████████████████████",
    'blue')
cprint(
    "                                           █▄─▄▄▀█▄─▄▄─█─▄─▄─█▄─▄▄─█─▄▄▄─█─▄─▄─███▄─▀█▀─▄██▀▄─██▄─▄███▄─█▀▀▀█─▄██▀▄─██▄─▄▄▀█▄─▄▄─█",
    'blue')
cprint(
    "                                           ██─██─██─▄█▀███─████─▄█▀█─███▀███─██████─█▄█─███─▀─███─██▀██─█─█─█─███─▀─███─▄─▄██─▄█▀█",
    'blue')
cprint(
    "                                           █▄▄▄▄██▄▄▄▄▄██▄▄▄██▄▄▄▄▄█▄▄▄▄▄██▄▄▄████▄▄▄█▄▄▄█▄▄█▄▄█▄▄▄▄▄██▄▄▄█▄▄▄██▄▄█▄▄█▄▄█▄▄█▄▄▄▄▄█",
    'blue')

cprint(
    "\n===========================================================================================================================================================",
    'red')
cprint(
    "===========================================================================================================================================================",
    'red')
cprint(
    "===========================================================================================================================================================\n",
    'red')

cprint('Welcome to Detect Malware. This software will help you scan viruses.', 'yellow', attrs=['bold'])

cprint('\nDetecting Malware using \'Netstat\'.', 'cyan', attrs=['bold'])
initializingNetstat()

cprint('\nShowing the active connections.', 'cyan', attrs=['bold'])
os.system('netstat -a')

cprint(
    "===========================================================================================================================================================\n",
    'red')

cprint('\nShowing the name of the applications creating the connections and listening ports.', 'cyan', attrs=['bold'])
os.system('netstat -b')

cprint(
    "===========================================================================================================================================================\n",
    'red')
cprint('\nShowing the port ID of the applications creating the connections and listening ports,', 'cyan',
       attrs=['bold'])
netstatPortNumber()
os.system('netstat -bno')

cprint(
    "===========================================================================================================================================================\n",
    'red')
cprint('')

while True:
    cprint('\n1: Terminate a single process.', 'yellow', attrs=['bold'])
    cprint('2: Terminate multiple processes.', 'yellow', attrs=['bold'])
    cprint('3: Exit malware detection process.', 'yellow', attrs=['bold'])
    try:
        choice = int(input('Enter your choice: '))
    except ValueError:
        cprint('Enter Numeric Value only.')

    if choice == 1:
        try:
            cprint('\nEnter the process ID that seems suspicious to you: ', 'cyan', attrs=['bold'])
            p_ID = input()
            command = "taskkill /pid " + p_ID + " /F"
            os.system(command)
        except [ValueError, Exception]:
            cprint('\n Entered process ID invalid or something might have gone wrong')

    elif choice == 2:
        try:
            cprint('\nEnter the process ID\'s that seems suspicious to you \"Example(123,456,789)\": ', 'cyan',
                   attrs=['bold'])
            p_ID = []
            p_ID = list(map(int, input().split(',')))

            for process in p_ID:
                command = "taskkill /pid " + str(process) + " /F"
                os.system(command)
        except[ValueError, Exception]:
            cprint('\n Entered process ID\'s are invalid or something might have gone wrong')

    elif choice == 3:
        break

    else:
        cprint('\nWrong input, Please try again.')

cprint(
    "===========================================================================================================================================================\n",
    'red')

cprint('\n Thank you for using \"DETECT MALWARE\".', 'cyan', attrs=['bold'])
choice = input('Go Back? (y/n): ')
if choice == 'y' or choice == 'Y':
    os.system('cls')
    os.system('python Kissing_Bug.py')
else:
    os.system('cls')
    exit()
